!function(){"use strict";function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}(self.webpackChunkhotely=self.webpackChunkhotely||[]).push([[4807],{14807:function(t,r,o){o.r(r),o.d(r,{OrderPageModule:function(){return U}});var l=o(12057),a=o(24751),c=o(33982),s=o(17936),u=o(73498),d=o(88002),f=o(74788);function b(e,t){if(1&e&&(f.TgZ(0,"ion-radio-group",2),f.TgZ(1,"ion-list-header"),f.TgZ(2,"ion-label"),f._uU(3,"Type de la commande"),f.qZA(),f.qZA(),f.TgZ(4,"ion-item"),f.TgZ(5,"ion-label"),f._uU(6,"\xc0 emporter"),f.qZA(),f._UZ(7,"ion-radio",3),f.qZA(),f.TgZ(8,"ion-item"),f.TgZ(9,"ion-label"),f._uU(10,"Sur place"),f.qZA(),f._UZ(11,"ion-radio",4),f.qZA(),f.qZA()),2&e){var n=f.oxw();f.Q6J("value",null==n.order?null:n.order.type)("formControl",n.orderTypeControl)}}function h(e,t){1&e&&(f.TgZ(0,"ion-label"),f._uU(1," Commande sur place "),f.qZA())}function p(e,t){1&e&&(f.TgZ(0,"ion-label"),f._uU(1," Commande \xe0 emporter "),f.qZA())}function g(e,t){if(1&e&&(f.TgZ(0,"ion-item"),f.YNc(1,h,2,0,"ion-label",5),f.YNc(2,p,2,0,"ion-label",5),f.qZA()),2&e){var n=f.oxw();f.xp6(1),f.Q6J("ngIf","ON_SITE"===(null==n.order?null:n.order.type)),f.xp6(1),f.Q6J("ngIf","TAKE_AWAY"===(null==n.order?null:n.order.type))}}var v,y=((v=function(){function e(){var t=this;n(this,e),this.typeSelected=new f.vpe,this.orderTypeControl=new a.NI,this.orderTypeSubscription=this.orderTypeControl.valueChanges.subscribe(function(e){t.readOnly||t.typeSelected.emit(e)})}return i(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||v)},v.\u0275cmp=f.Xpm({type:v,selectors:[["mobile-order-type-select"]],inputs:{order:"order",readOnly:"readOnly"},outputs:{typeSelected:"typeSelected"},decls:3,vars:2,consts:[[3,"value","formControl",4,"ngIf","ngIfElse"],["readOnlyOrderType",""],[3,"value","formControl"],["slot","start","value","TAKE_AWAY"],["slot","start","value","ON_SITE"],[4,"ngIf"]],template:function(e,t){if(1&e&&(f.YNc(0,b,12,2,"ion-radio-group",0),f.YNc(1,g,3,2,"ng-template",null,1,f.W1O)),2&e){var n=f.MAs(2);f.Q6J("ngIf",!t.readOnly)("ngIfElse",n)}},directives:[l.O5,u.se,u.QI,a.JJ,a.oH,u.yh,u.Q$,u.Ie,u.B7,u.U5],styles:[""]}),v);function m(e,t){if(1&e&&(f.TgZ(0,"ion-select-option",2),f._uU(1),f.qZA()),2&e){var n=t.$implicit;f.Q6J("value",n.id)("disabled",!n.available),f.xp6(1),f.hij(" ",n.name," ")}}var T=function(){var e=function(){function e(){n(this,e),this.tableSelect=new f.vpe,this.tableSelectControl=new a.NI}return i(e,[{key:"disabled",set:function(e){e&&this.tableSelectControl.disable()}},{key:"tables",set:function(e){var t=this;e&&(this._tables=e,this.tableSelectControl.setValue(this.order.table),this.selectedTable=e.find(function(e){return e.id===t.order.table}),this.tableSelected({detail:{value:this.order.table}}))}},{key:"ngOnInit",value:function(){}},{key:"tableSelected",value:function(e){this.tableSelect.emit(e.detail.value)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=f.Xpm({type:e,selectors:[["mobile-table-select"]],inputs:{order:"order",disabled:"disabled",tables:"tables"},outputs:{tableSelect:"tableSelect"},decls:5,vars:3,consts:[["placeholder","Choisir la table",3,"formControl","selectedText","ionChange"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"]],template:function(e,t){1&e&&(f.TgZ(0,"ion-item"),f.TgZ(1,"ion-label"),f._uU(2,"Table"),f.qZA(),f.TgZ(3,"ion-select",0),f.NdJ("ionChange",function(e){return t.tableSelected(e)}),f.YNc(4,m,2,3,"ion-select-option",1),f.qZA(),f.qZA()),2&e&&(f.xp6(3),f.Q6J("formControl",t.tableSelectControl)("selectedText",null==t.selectedTable?null:t.selectedTable.name),f.xp6(1),f.Q6J("ngForOf",t._tables))},directives:[u.Ie,u.Q$,u.t9,u.QI,a.JJ,a.oH,l.sg,u.n0],styles:[""]}),e}(),Z=o(90902),S=function(){var e=function(){function e(t){n(this,e),this.orderService=t,this.qty=0}return i(e,[{key:"order",set:function(e){this.updqateQty(e)}},{key:"ngOnInit",value:function(){}},{key:"incrementOrderDish",value:function(e){this.orderService.addDish(e)}},{key:"decrementOrderDish",value:function(e){this.orderService.decrementQtyOfOrderDish(e)}},{key:"updqateQty",value:function(e){var t=this.orderService.findIndexOfDish(this.dish.id,e);this.qty=t>=0?e.dishes[t].qty:0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(f.Y36(s.px))},e.\u0275cmp=f.Xpm({type:e,selectors:[["mobile-dish"]],inputs:{dish:"dish",order:"order"},decls:14,vars:6,consts:[["slot","end",1,"quantity"],["size","small","color","primary",1,"btn-change-qty",3,"click"],["color","light"]],template:function(e,t){1&e&&(f.TgZ(0,"ion-item"),f.TgZ(1,"ion-label"),f.TgZ(2,"h2"),f._uU(3),f.qZA(),f.TgZ(4,"p"),f._uU(5),f.ALo(6,"currency"),f.qZA(),f.qZA(),f.TgZ(7,"div",0),f.TgZ(8,"ion-button",1),f.NdJ("click",function(){return t.decrementOrderDish(t.dish)}),f._uU(9," - "),f.qZA(),f.TgZ(10,"ion-button",2),f._uU(11),f.qZA(),f.TgZ(12,"ion-button",1),f.NdJ("click",function(){return t.incrementOrderDish(t.dish)}),f._uU(13," + "),f.qZA(),f.qZA(),f.qZA()),2&e&&(f.xp6(3),f.hij(" ",t.dish.name," "),f.xp6(2),f.hij(" ",f.xi3(6,3,t.dish.price,"Ar")," "),f.xp6(6),f.hij(" ",t.qty," "))},directives:[u.Ie,u.Q$,u.YG],pipes:[l.H9],styles:[".btn-change-qty[_ngcontent-%COMP%]{font-weight:700}"]}),e}();function I(e,t){if(1&e&&(f.ynx(0),f._UZ(1,"mobile-dish",1),f.BQk()),2&e){var n=t.$implicit,r=f.oxw();f.xp6(1),f.Q6J("dish",n)("order",r.order)}}var A=function(){var t=function(){function t(){n(this,t)}return i(t,[{key:"categoryId",set:function(t){this.dishesToShow=e(this.menu.dishes).filter(function(e){return e.categoryId===t})}},{key:"ngOnInit",value:function(){}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=f.Xpm({type:t,selectors:[["mobile-menu"]],inputs:{menu:"menu",categoryId:"categoryId",order:"order"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"dish","order"]],template:function(e,t){1&e&&(f.TgZ(0,"ion-list"),f.YNc(1,I,2,2,"ng-container",0),f.qZA()),2&e&&(f.xp6(1),f.Q6J("ngForOf",t.dishesToShow))},directives:[u.q_,l.sg,S],styles:[""]}),t}();function O(e,t){if(1&e){var n=f.EpF();f.TgZ(0,"ion-fab-button",4),f.NdJ("click",function(){f.CHM(n);var e=f.oxw().ngIf;return f.oxw().validateOrder(e)}),f._UZ(1,"ion-icon",5),f.qZA()}if(2&e){var r=f.oxw().ngIf;f.Q6J("disabled",!(r.dishes.length>0&&r.table))}}function x(e,t){if(1&e){var n=f.EpF();f.TgZ(0,"mobile-table-select",6),f.NdJ("tableSelect",function(e){return f.CHM(n),f.oxw(2).tableSelected(e)}),f.ALo(1,"async"),f.qZA()}if(2&e){var r=f.oxw().ngIf,i=f.oxw();f.Q6J("order",r)("tables",f.lcZ(1,3,i.tables$))("disabled",i.editMode)}}function C(e,t){if(1&e&&f._UZ(0,"hotely-order-table",8),2&e){var n=f.oxw(2).ngIf;f.Q6J("tableId",n.table)}}function k(e,t){if(1&e&&(f.ynx(0),f.TgZ(1,"ion-item"),f.TgZ(2,"ion-label"),f._uU(3," Commande num: "),f.YNc(4,C,1,1,"hotely-order-table",7),f.qZA(),f.qZA(),f.BQk()),2&e){var n=f.oxw().ngIf;f.xp6(4),f.Q6J("ngIf",n.table)}}function q(e,t){if(1&e&&(f.TgZ(0,"ion-segment-button",12),f.TgZ(1,"ion-label"),f._uU(2),f.qZA(),f.qZA()),2&e){var n=t.$implicit;f.Q6J("value",n.id),f.xp6(2),f.Oqu(n.name)}}function w(e,t){if(1&e&&f._UZ(0,"mobile-menu",13),2&e){var n=t.$implicit,r=f.oxw().ngIf,i=f.oxw(2).ngIf,o=f.oxw();f.Q6J("menu",n)("categoryId",o.currentCategoryId||r[0].id)("order",i)}}function J(e,t){if(1&e){var n=f.EpF();f.ynx(0),f.TgZ(1,"ion-segment",9),f.NdJ("ionChange",function(e){return f.CHM(n),f.oxw(3).categoryChanged(e)}),f.YNc(2,q,3,2,"ion-segment-button",10),f.qZA(),f.YNc(3,w,1,3,"mobile-menu",11),f.ALo(4,"async"),f.BQk()}if(2&e){var r=t.ngIf,i=f.oxw(3);f.xp6(1),f.Q6J("value",r[0].id),f.xp6(1),f.Q6J("ngForOf",r),f.xp6(1),f.Q6J("ngForOf",f.lcZ(4,3,i.menus$))}}function Q(e,t){if(1&e&&(f.ynx(0),f.YNc(1,J,5,5,"ng-container",1),f.ALo(2,"async"),f.BQk()),2&e){var n=f.oxw(2);f.xp6(1),f.Q6J("ngIf",f.lcZ(2,1,n.categories$))}}function _(e,t){if(1&e&&(f.ynx(0),f.YNc(1,O,2,1,"ion-fab-button",2),f.YNc(2,x,2,5,"mobile-table-select",3),f.YNc(3,k,5,1,"ng-container",1),f.YNc(4,Q,3,3,"ng-container",1),f.BQk()),2&e){var n=t.ngIf;f.xp6(1),f.Q6J("ngIf",n.dishes),f.xp6(1),f.Q6J("ngIf","ON_SITE"===n.type),f.xp6(1),f.Q6J("ngIf","TAKE_AWAY"===n.type),f.xp6(1),f.Q6J("ngIf",n.table)}}var N=function(){var e=function(){function e(t,r,i,o,l,c,s){n(this,e),this.menuService=t,this.orderService=r,this.toastService=i,this.router=o,this.tableService=l,this.categoryService=c,this.route=s,this.tables$=this.tableService.getOnSiteTables(),this.tempTables$=this.tableService.getTempTables().pipe((0,d.U)(function(e){return e.filter(function(e){return e.available})})),this.order$=this.orderService.orderSubject$,this.categories$=this.categoryService.getCategories(),this.editMode=!1,this.orderTypeControl=new a.NI,this.orderService.removeLocalOrder()}return i(e,[{key:"ngOnInit",value:function(){this.getMenus(),this.initializeOrder()}},{key:"ngOnDestroy",value:function(){this.categoriesSubscription&&this.categoriesSubscription.unsubscribe(),this.orderSubscription&&this.orderSubscription.unsubscribe(),this.orderTypeSubscription&&this.orderTypeSubscription.unsubscribe()}},{key:"initializeOrder",value:function(){var e=this.route.snapshot.params.orderId;e?(this.setEditMode(!0),this.initializeOrderToEdit(e)):this.initializeNewOrder()}},{key:"getMenus",value:function(){this.menus$=this.menuService.getMenus()}},{key:"selectOrderType",value:function(e){this.orderService.initializeOrder(null,e),this.editMode||e===s.Jm.TAKE_AWAY&&this.useTempTable()}},{key:"useTempTable",value:function(){var e=this;this.tableService.tempTableAvailable().subscribe(function(t){t?e.tableSelected(t.id):e.tableService.addTempTable().subscribe(function(t){e.tableSelected(t.id)})})}},{key:"validateOrder",value:function(e){var t=this;this.orderService.validate(e).subscribe(function(e){t.setCurrentTable(null),t.toastService.notify({message:"Commande Valid\xe9e"}),t.orderService.removeLocalOrder(),t.router.navigate(["orders"])})}},{key:"categoryChanged",value:function(e){var t=e.detail.value;this.currentCategoryId=t}},{key:"tableSelected",value:function(e){this.setCurrentTable(e),this.orderService.updateCurrentOrder({table:e})}},{key:"initializeNewOrder",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s.Jm.TAKE_AWAY;this.currentOrderType=e}},{key:"initializeOrderToEdit",value:function(e){var t=this;this.orderService.getOrderById(e).valueChanges().subscribe(function(n){t.orderService.setCurrentOrder(Object.assign(Object.assign({},n),{id:e}))})}},{key:"setEditMode",value:function(e){this.editMode=e}},{key:"setCurrentTable",value:function(e){this.currentTable=e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(f.Y36(s.hl),f.Y36(s.px),f.Y36(s.kl),f.Y36(c.F0),f.Y36(s.wm),f.Y36(s.HE),f.Y36(c.gz))},e.\u0275cmp=f.Xpm({type:e,selectors:[["mobile-order"]],decls:5,vars:7,consts:[[3,"order","readOnly","typeSelected"],[4,"ngIf"],["class","validate-button","color","primary",3,"disabled","click",4,"ngIf"],[3,"order","tables","disabled","tableSelect",4,"ngIf"],["color","primary",1,"validate-button",3,"disabled","click"],["name","checkmark-outline"],[3,"order","tables","disabled","tableSelect"],[3,"tableId",4,"ngIf"],[3,"tableId"],["scrollable","",3,"value","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"menu","categoryId","order",4,"ngFor","ngForOf"],[3,"value"],[3,"menu","categoryId","order"]],template:function(e,t){1&e&&(f.TgZ(0,"ion-content"),f.TgZ(1,"mobile-order-type-select",0),f.NdJ("typeSelected",function(e){return t.selectOrderType(e)}),f.ALo(2,"async"),f.qZA(),f.YNc(3,_,5,4,"ng-container",1),f.ALo(4,"async"),f.qZA()),2&e&&(f.xp6(1),f.Q6J("order",f.lcZ(2,3,t.order$))("readOnly",t.editMode),f.xp6(2),f.Q6J("ngIf",f.lcZ(4,5,t.order$)))},directives:[u.W2,y,l.O5,u.W4,u.gu,T,u.Ie,u.Q$,Z.C,u.cJ,u.QI,l.sg,u.GO,A],pipes:[l.Ov],styles:[".validate-button[_ngcontent-%COMP%]{position:fixed;bottom:20px;right:20px}"]}),e}(),Y=[{path:"",children:[{path:"",component:N},{path:"edit/:orderId",component:N}]}],U=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=f.oAB({type:e}),e.\u0275inj=f.cJS({imports:[[l.ez,a.u5,a.UX,u.Pc,c.Bz.forChild(Y),s.IR]]}),e}()}}])}();