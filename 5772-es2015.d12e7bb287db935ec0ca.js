"use strict";(self.webpackChunkhotely=self.webpackChunkhotely||[]).push([[5772],{15772:function(e,t,s){s.r(t),s.d(t,{OrdersPageModule:function(){return Z}});var r=s(12057),i=s(24751),n=s(33982),o=s(17936),a=s(73498),l=s(64762);"undefined"!=typeof window&&window,"undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self;"undefined"!=typeof global&&global;function c(e){return e.reduce((e,t)=>{const s=Array.isArray(t)?c(t):t;return e.concat(s)},[])}Object.keys({useClass:null}),Object.keys({useFactory:null}),Object.keys({useValue:null}),Object.keys({useExisting:null});var h=s(90739),u=s(56693),d=s(59796),p=s(77393),f=s(20377),b=s(85345);class g{constructor(e){this.resultSelector=e}call(e,t){return t.subscribe(new v(e,this.resultSelector))}}class v extends p.L{constructor(e,t,s=Object.create(null)){super(e),this.resultSelector=t,this.iterators=[],this.active=0,this.resultSelector="function"==typeof t?t:void 0}_next(e){const t=this.iterators;(0,d.k)(e)?t.push(new y(e)):t.push("function"==typeof e[f.hZ]?new m(e[f.hZ]()):new S(this.destination,this,e))}_complete(){const e=this.iterators,t=e.length;if(this.unsubscribe(),0!==t){this.active=t;for(let s=0;s<t;s++){let t=e[s];t.stillUnsubscribed?this.destination.add(t.subscribe()):this.active--}}else this.destination.complete()}notifyInactive(){this.active--,0===this.active&&this.destination.complete()}checkIterators(){const e=this.iterators,t=e.length,s=this.destination;for(let n=0;n<t;n++){let t=e[n];if("function"==typeof t.hasValue&&!t.hasValue())return}let r=!1;const i=[];for(let n=0;n<t;n++){let t=e[n],o=t.next();if(t.hasCompleted()&&(r=!0),o.done)return void s.complete();i.push(o.value)}this.resultSelector?this._tryresultSelector(i):s.next(i),r&&s.complete()}_tryresultSelector(e){let t;try{t=this.resultSelector.apply(this,e)}catch(s){return void this.destination.error(s)}this.destination.next(t)}}class m{constructor(e){this.iterator=e,this.nextResult=e.next()}hasValue(){return!0}next(){const e=this.nextResult;return this.nextResult=this.iterator.next(),e}hasCompleted(){const e=this.nextResult;return Boolean(e&&e.done)}}class y{constructor(e){this.array=e,this.index=0,this.length=0,this.length=e.length}[f.hZ](){return this}next(e){const t=this.index++;return t<this.length?{value:this.array[t],done:!1}:{value:null,done:!0}}hasValue(){return this.array.length>this.index}hasCompleted(){return this.array.length===this.index}}class S extends b.Ds{constructor(e,t,s){super(e),this.parent=t,this.observable=s,this.stillUnsubscribed=!0,this.buffer=[],this.isComplete=!1}[f.hZ](){return this}next(){const e=this.buffer;return 0===e.length&&this.isComplete?{value:null,done:!0}:{value:e.shift(),done:!1}}hasValue(){return this.buffer.length>0}hasCompleted(){return 0===this.buffer.length&&this.isComplete}notifyComplete(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()}notifyNext(e){this.buffer.push(e),this.parent.checkIterators()}subscribe(){return(0,b.ft)(this.observable,new b.IY(this))}}var O=s(43190),x=s(88002),A=s(74788),E=s(90902),C=s(69591);let k=(()=>{class e{constructor(){this.changed=new A.vpe}set status(e){switch(e){case C.q.PENDING:this._status={label:"En attente",color:"primary"};break;case C.q.PREPARING:this._status={label:"En pr\xe9paration",color:"secondary"};break;case C.q.READY:this._status={label:"Pr\xeat",color:"success"};break;case C.q.SERVED:this._status={label:"Servie",color:"medium"};break;case C.q.CANCELED:this._status={label:"Annul\xe9e",color:"danger"};break;case C.q.DONE:this._status={label:"Termin\xe9e",color:"success"};break;default:this._status={label:"En Attente",color:"primary"}}this.changed.emit(this._status)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=A.Xpm({type:e,selectors:[["hotely-order-status"]],inputs:{status:"status"},outputs:{changed:"changed"},decls:2,vars:1,consts:[[1,"order-status"]],template:function(e,t){1&e&&(A.TgZ(0,"span",0),A._uU(1),A.qZA()),2&e&&(A.xp6(1),A.Oqu(t._status.label))},encapsulation:2}),e})();function q(e,t){if(1&e){const e=A.EpF();A.TgZ(0,"ion-item",1),A.NdJ("click",function(){const t=A.CHM(e).$implicit;return A.oxw().selectOrder(t)}),A.TgZ(1,"ion-label"),A._UZ(2,"hotely-order-table",2),A.qZA(),A.TgZ(3,"ion-note",3,4),A.TgZ(5,"hotely-order-status",5),A.NdJ("changed",function(t){return A.CHM(e),A.MAs(4).color=t.color}),A.qZA(),A.qZA(),A.qZA()}if(2&e){const e=t.$implicit;A.xp6(2),A.Q6J("tableId",e.table),A.xp6(3),A.Q6J("status",e.status)}}const w=[{path:"",component:(()=>{class e{constructor(e,t,s,r){this.orderService=e,this.actionSheetController=t,this.router=s,this.toastService=r,this.pendingOrders$=this.orderService.getOrdersByStatus(o.qb.PENDING),this.preparingOrders$=this.orderService.getOrdersByStatus(o.qb.PREPARING),this.readyOrders$=this.orderService.getOrdersByStatus(o.qb.READY),this.servedOrders$=this.orderService.getOrdersByStatus(o.qb.SERVED),this.orders$=(0,h.aj)([this.preparingOrders$,this.pendingOrders$,this.servedOrders$,this.readyOrders$]).pipe((0,O.w)(e=>function(...e){const t=e[e.length-1];return"function"==typeof t&&e.pop(),(0,u.n)(e,void 0).lift(new g(t))}(this.preparingOrders$,this.pendingOrders$,this.servedOrders$,this.readyOrders$).pipe((0,x.U)(e=>c(e)))))}ngOnInit(){}selectOrder(e){this.showActions(e)}getActionsButtons(e,t){switch(e){case"edit":return{text:"Modifier",icon:"create-outline",handler:()=>{this.handleEdit(t)}};case"delete":return{text:"Supprimer",role:"destructive",icon:"trash",handler:()=>{this.handleRemove(t)}};case"serve":return{text:"Servir",role:"destructive",icon:"checkmark-done-outline",handler:()=>{this.handleServed(t)}};case"cancel":return{text:"Annuler",role:"destructive",icon:"trash-outline",handler:()=>{this.handleCancel(t)}};case"finish":return{text:"Terminer",role:"destructive",icon:"done",handler:()=>{this.handleFinish(t)}}}}showActions(e){return(0,l.mG)(this,void 0,void 0,function*(){yield(yield this.actionSheetController.create({header:"Actions",buttons:[...(()=>{switch(e.status){case o.qb.PENDING:return[this.getActionsButtons("edit",e),this.getActionsButtons("delete",e),this.getActionsButtons("cancel",e)];case o.qb.READY:return[this.getActionsButtons("serve",e)];case o.qb.SERVED:return[this.getActionsButtons("finish",e)];default:return[]}})(),{text:"Fermer",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]})).present()})}handleEdit(e){this.router.navigate([`order/edit/${e.id}`])}handleRemove(e){this.orderService.removeOrder(e).subscribe(()=>{this.toastService.notify({message:"Commande supprim\xe9e"})})}handleServed(e){this.setOrderStatus(e,o.qb.SERVED)}handleCancel(e){this.setOrderStatus(e,o.qb.CANCELED)}handleFinish(e){this.setOrderStatus(e,o.qb.DONE)}setOrderStatus(e,t){this.orderService.setOrderStatus(e,t).subscribe(()=>{this.toastService.notify({message:"Commande modifi\xe9e"})})}}return e.\u0275fac=function(t){return new(t||e)(A.Y36(o.px),A.Y36(a.BX),A.Y36(n.F0),A.Y36(o.kl))},e.\u0275cmp=A.Xpm({type:e,selectors:[["mobile-orders"]],decls:4,vars:3,consts:[[3,"click",4,"ngFor","ngForOf"],[3,"click"],[3,"tableId"],["slot","end"],["noteStatus",""],[3,"status","changed"]],template:function(e,t){1&e&&(A.TgZ(0,"ion-content"),A.TgZ(1,"ion-list"),A.YNc(2,q,6,2,"ion-item",0),A.ALo(3,"async"),A.qZA(),A.qZA()),2&e&&(A.xp6(2),A.Q6J("ngForOf",A.lcZ(3,1,t.orders$)))},directives:[a.W2,a.q_,r.sg,a.Ie,a.Q$,E.C,a.uN,k],pipes:[r.Ov],styles:[""]}),e})()}];let Z=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=A.oAB({type:e}),e.\u0275inj=A.cJS({imports:[[r.ez,i.u5,a.Pc,n.Bz.forChild(w),o.IR]]}),e})()}}]);